# 4.3 Fibonacci 探索
図4.3に示すように不確実な範囲$I\_k = \[ x\_{L,k}, x\_{U,k} \]$ 及び 
$I\_k$に位置する$x\_{a,k}, x\_{b,k}$ について考える。
4.2節のように、$f(x\_{a,k}), f(x\_{b,k})$で書かれる、$x\_{a,k}, x\_{b,k}$における$f(x)$の値は、
もし,$f(x\_{a,k}) < f(x\_b,k)$であれば、左側の範囲を
$I\_{k+1}^{L} = \[ x\_{L,k}, x\_{b,k} \]\]$として選択するため、

もし,$f(x\_{a,k}) > f(x\_b,k)$であれば、右側の範囲を
$I\_{k+1}^{R} = \[ x\_{a,k}, x\_{U,k} \]$ として選択するため、

さもなくば、$f(x\_a, k) = f(x\_b, k)$であれば、$I\_{k+1}^R$と$I\_{k+1}^L$
のどちらかを選択するために使われる。

もし、右の区間$I^R\_{k+1}$が選択された場合、その範囲は最小点を含み、
それに加え、$f(x)$の値は$I^R\_{k+1}$の範囲内の一点でわかっている、すなわち$x\_{b,k}$の点である。
また$f(x)$が$I^R\_{k+1}$内の一つ以上の点、つまり$x\_{b, k+1}$の点で評価されるとき、
さらに不確実な区間を縮小するための十分な情報が利用可能であり、そして、上記の循環は繰り返される。
図4.3で示されるような$I\_{k+2}^L$と$I\_{k+2}^R$の二つの新しい部分区間のうち一つを、
前述のように選択することが可能である。
この方法では、一回の繰り返しに対しただ一つの関数評価が要求され、
計算量は二分探索法で要求される計算量と比較して削減されるだろう。

図4.3では

$$I\_k = I\_{k+1}^L + I\_{k+2}^R \tag{4.1}$$

としていて、そして便宜上、同一の区間である場合、

$$I\_{k+1}^L = I\_{k+1}^R = I\_{k+1}$$
$$I\_{k+2}^L = I\_{k+2}^R = I\_{k+2}$$

式$4.1$は

$$I\_k = I\_{k+1} + I\_{k+2} \tag{4.2}$$

という再帰的な関係を示している。

上記の手順が何回も繰り返されるとき、$\{ I\_1, I\_2, \cdots , I\_n \}$ の順序は次のように得られる

$$
\begin{array}{c}
  I\_1 = I\_2 + I\_3 \\\\
  I\_2 = I\_3 + I\_4 \\\\
  \vdots \\\\
  I\_n = I\_{n+1} + I\_{n+2} \\\\
\end{array}
$$

上記の一連の$n$個の方程式では、$n + 2$個の変数があり、そして$I\_1$が初期区間として与えられた時
$n + 1$個の変数が残ります。
それゆえに、無限個の順序は何らかの追加のルールを指定することで得られる。
特に重要な2つの特殊な順序はFibonacci数列と黄金分割数列である。
Fibonacci数列はこの章で、黄金分割数列は4.4章で考える。

Fibonacci数列は$n+2$回目の繰り返しで零になる範囲、つまり$I\_{n+2} = 0$を仮定することで得られる。
式$4.2$で$k = n$と置けば、次のように書ける。
$$
\begin{array}{c}
I\_{n+1} = I\_n - I\_{n+2} = I\_n \equiv F\_0I\_n \\\\
I\_{n} = I\_{n+1} + I\_{n+2} = I\_n \equiv F\_1I\_n \\\\
I\_{n-1} = I\_n + I\_{n+1} = 2I\_n \equiv F\_2I\_n \\\\
I\_{n-2} = I\_{n-1} + I\_{n} = 3I\_n \equiv F\_3I\_n \\\\
I\_{n-3} = I\_{n-2} + I\_{n-1} = 5I\_n \equiv F\_4I\_n \\\\
I\_{n-4} = I\_{n-3} + I\_{n-2} = 8I\_n \equiv F\_5I\_n \\\\
\vdots \\\\
I\_k = I\_{k+1} + I\_{k+2} = F\_{n - k + 1}I\_n \ \cdots\ (4.3a) \\\\
\vdots \\\\
I\_1 = I\_2 + I\_3 = F\_nI\_n \ \cdots\ (4.3b)
\end{array}
$$

得られた数列、すなわち
$\lbrace1, 1, 2, 3, 5, 8, 13, \cdots \rbrace
 = \lbrace F\_0, F\_1, F\_2, F\_3, F\_4, F\_5, F\_6, \cdots \rbrace
$
の数列は、数学の様々な分野に存在するFibonacci数列としてよく知られている。

それは$F\_0 = F\_1 = 0 $ の下での再帰的な関係によって生まれ、
$ F\_k = F\_{k-1} + F\_{k-2} \ for \ k \geq 2 \tag{4.4} $
である。

一次元最適化におけるこれの応用はFibonacci探索法である。
この方法の、$n = 4, I\_1 = 100 $で始まり、常に左側の範囲が選択された場合、
つまり最小値が$x = 0$の近傍で存在する場合が、図4.4で描かれている。

もし、繰り返しの回数が$n$になると仮定すると、式$(4.3b)$から、Fibonacci探索は不確実な範囲を
$I\_n = \frac{I\_1}{F\_n} \tag{4.5}$
に縮小する。

例えば、もし$n = 11$なら、$F\_n = 144$ なので、$I\_n$は$I\_1$の値の$1\%$未満の値に縮小される。
これは11回の反復を伴い、各反復に一回の関数の評価が必要になるので、
同じだけの正確さを得るために14回の関数評価が必要な二分探索法に対して、合計11回の関数の評価が必要になる。
事実上Fibonacci探索は二分探索に比べて効率が良い。
それにまた、他の探索法に比べて最も大きな範囲の削減を達成していることも示されている、
そしてしたがって、必要計算量の面においても最も効率的である。

区間のFibonacci数列は$n$が明らかになっている場合のみ得られる。
もし、最適化の目的が規定された許容誤差の範囲で$x^{\*}$を見つけることの場合、
要求される$n$は式$(4.5)$を用いることで用意に推測できる。
しかしながら、もし目的が$f(x)$の最小値を規定された許容誤差の範囲で見つけることの場合、
問題を解かずに要求される$n$を決めるのは難しくなるだろう。
唯一利用可能な情報は、もし$f(x)$の最小値が厳密でなく、$f(x)$が解の近傍で急速に変化する場合に、
$n$が小さくなるだろうということである。

